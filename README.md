# ü¶∏‚Äç‚ôÇÔ∏è FlashImage

‚ö†Ô∏è **CAUTION: This package is still a work-in-progress and isn't recommended for production use as of yet.**

---

**FlashImage** is a spiritual successor to [@DylanVann's](https://github.com/DylanVann) [`react-native-fast-image`](https://github.com/DylanVann/react-native-fast-image) package. 

It is built with the [new React Native architecture](https://reactnative.dev/architecture/overview) in mind and acts as a drop-in replacement for React Native's standard [`Image`](https://reactnative.dev/docs/image) component **on iOS**. 

However, this package is not intended to be a direct replacement of `FastImage`. Availability of APIs may vary and some features such as authorization headers are going to be missing.

Under the hood, it uses [Nuke](https://github.com/kean/Nuke) on iOS and [Coil](https://coil-kt.github.io/coil/) on Android.

## Installation

```sh
npm i react-native-flash-image
npx pod-install
```

Autolinking on Android doesn‚Äôt work with the new architecture out of the box, therefore you need to do the following steps:

1. Open the `NewArchitecture/android/app/build.gradle` file and update the file as it follows:
    ```diff
        "PROJECT_BUILD_DIR=$buildDir",
        "REACT_ANDROID_DIR=$rootDir/../node_modules/react-native/ReactAndroid",
    -   "REACT_ANDROID_BUILD_DIR=$rootDir/../node_modules/react-native/ReactAndroid/build"
    +   "REACT_ANDROID_BUILD_DIR=$rootDir/../node_modules/react-native/ReactAndroid/build",
    +   "NODE_MODULES_DIR=$rootDir/../node_modules/"
        cFlags "-Wall", "-Werror", "-fexceptions", "-frtti", "-DWITH_INSPECTOR=1"
        cppFlags "-std=c++17"
    ```
2. Open the `NewArchitecture/android/app/src/main/jni/Android.mk` file and update the file as it follows:
    ```diff
        # If you wish to add a custom TurboModule or Fabric component in your app you
        # will have to include the following autogenerated makefile.
        # include $(GENERATED_SRC_DIR)/codegen/jni/Android.mk
    +
    +   # Includes the MK file for `react-native-flash-image`
    +
    +   include $(NODE_MODULES_DIR)/react-native-flash-image/android/build/generated/source/codegen/jni/Android.mk
        include $(CLEAR_VARS)
    ```
3. In the same file above, go to the `LOCAL_SHARED_LIBRARIES` setting and add the following line:
    ```diff
        libreact_codegen_rncore \
    +   libreact_codegen_rnflashimage \
        libreact_debug \
    ```
4. Open the `NewArchitecture/android/app/src/main/jni/MainComponentsRegistry.cpp` file and update the file as it follows:
    1. Add the import for the calculator:
        ```diff
            #include <react/renderer/components/answersolver/ComponentDescriptors.h>
        +   #include <react/renderer/components/rnflashimage/ComponentDescriptors.h>
            #include <react/renderer/components/rncore/ComponentDescriptors.h>
        ```
    2. Add the following check in the `sharedProviderRegistry` constructor:
        ```diff
            auto providerRegistry = CoreComponentsRegistry::sharedProviderRegistry();

            // Custom Fabric Components go here. You can register custom
            // components coming from your App or from 3rd party libraries here.
            //
        -   // providerRegistry->add(concreteComponentDescriptorProvider<
        -   //        AocViewerComponentDescriptor>());
        +   providerRegistry->add(concreteComponentDescriptorProvider<FlashImageComponentDescriptor>());

            return providerRegistry;
        }
        ```

## Usage

```js
import { FlashImage } from "react-native-flash-image";

<FlashImage source="https://loremflickr.com/320/240" />
```

## Contributing

See the [contributing guide](CONTRIBUTING.md) to learn how to contribute to the repository and the development workflow.

## License

MIT
