# 🦸‍♂️ FlashImage

> ⚠️ **CAUTION: This package is still a work-in-progress and isn't recommended for production use as of yet.**

**FlashImage** is a spiritual successor to [@DylanVann's](https://github.com/DylanVann) [`react-native-fast-image`](https://github.com/DylanVann/react-native-fast-image) package.

It is built with the [new React Native architecture](https://reactnative.dev/architecture/overview) in mind and _mostly_ acts as a drop-in replacement for React Native's standard [`Image`](https://reactnative.dev/docs/image) component. However, availability of props may vary and some features such as [class methods](https://reactnative.dev/docs/image#methods) are going to be missing.

Under the hood, it uses [Nuke](https://github.com/kean/Nuke) on iOS and [Glide](https://github.com/bumptech/glide) on Android.

## Installation

> `react-native-flash-image` will only work with `react-native@0.69` and higher. Older versions are not supported and won't work due to the required changes in React Native core [(#33743)](https://github.com/facebook/react-native/commit/709a459b1ef7968d447c0a5dbe5cd44d1e03fcb4).

```sh
npm i react-native-flash-image
npx pod-install
```

### Android

As of now, there are still a few more steps to get this package working on Android.

Autolinking on Android doesn’t work with the new architecture out of the box, therefore you need to do the following steps:

1. Open the `android/app/src/main/jni/Android.mk` file and update the file as it follows:
   
    ```diff
        # If you wish to add a custom TurboModule or Fabric component in your app you
        # will have to include the following autogenerated makefile.
        # include $(GENERATED_SRC_DIR)/codegen/jni/Android.mk
    
    +   include $(NODE_MODULES_DIR)/react-native-flash-image/android/build/generated/source/codegen/jni/Android.mk
        include $(CLEAR_VARS)
    ```

2. In the same file above, go to the `LOCAL_SHARED_LIBRARIES` setting and add the following line:
   
    ```diff
        libreact_codegen_rncore \
    +   libreact_codegen_rnflashimage \
        libreact_debug \
    ```

3. Open the `android/app/src/main/jni/MainComponentsRegistry.cpp` file and update the file as it follows:
   
    1. Add the import:

        ```diff
            #include <react/renderer/componentregistry/ComponentDescriptorProviderRegistry.h>
            #include <react/renderer/components/rncore/ComponentDescriptors.h>
        +   #include <react/renderer/components/rnflashimage/ComponentDescriptors.h>
        ```

    2. Add component descriptor to a shared provider registry:

        ```diff
            auto providerRegistry = CoreComponentsRegistry::sharedProviderRegistry();

            // Custom Fabric Components go here. You can register custom
            // components coming from your App or from 3rd party libraries here.
        -   //
        -   // providerRegistry->add(concreteComponentDescriptorProvider<
        -   //        AocViewerComponentDescriptor>());
        + 
        +   providerRegistry->add(concreteComponentDescriptorProvider<FlashImageViewComponentDescriptor>());
            return providerRegistry;
        }
        ```

If you are using Glide within your application using an `AppGlideModule`, then you will need to prevent the inclusion of the `AppGlideModule` in this package.

You can do this by setting `project.ext.excludeAppGlideModule` to `true` in `android/build.gradle`:

```gradle
project.ext {
  excludeAppGlideModule = true
}
```

## Usage

_A more detailed documentation is coming soon. For now, you can rely on the built-in types if you're really eager to try this package out._

```js
import { FlashImage } from "react-native-flash-image";

<FlashImage source={{uri: "https://loremflickr.com/320/240"}} />
```

## Contributing

See the [contributing guide](CONTRIBUTING.md) to learn how to contribute to the repository and the development workflow.

## License

MIT
